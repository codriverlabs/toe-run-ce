---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: powertools.codriverlabs.ai.toe.run
spec:
  group: codriverlabs.ai.toe.run
  names:
    kind: PowerTool
    listKind: PowerToolList
    plural: powertools
    singular: powertool
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: PowerTool is the Schema for the powertools API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired state of PowerTool
            properties:
              budgets:
                description: BudgetSpec defines the budget configuration
                properties:
                  maxConcurrentPods:
                    format: int32
                    type: integer
                  perPodOverheadTarget:
                    format: int32
                    type: integer
                type: object
              failurePolicy:
                description: FailurePolicySpec defines the failure policy
                properties:
                  backoff:
                    description: BackoffSpec defines the backoff configuration
                    properties:
                      initial:
                        type: string
                      max:
                        type: string
                      multiplier:
                        type: string
                    type: object
                  onError:
                    type: string
                type: object
              output:
                description: OutputSpec defines the output configuration
                properties:
                  collector:
                    description: CollectorSpec defines the collector output configuration
                    properties:
                      endpoint:
                        type: string
                    required:
                    - endpoint
                    type: object
                  compress:
                    type: string
                  mode:
                    type: string
                  pvc:
                    description: PVCSpec defines the PVC output configuration
                    properties:
                      claimName:
                        type: string
                      path:
                        type: string
                    required:
                    - claimName
                    type: object
                  retentionDays:
                    format: int32
                    type: integer
                  rollingInterval:
                    type: string
                required:
                - mode
                type: object
              schedule:
                type: string
              targets:
                description: TargetSpec defines the target for tool execution
                properties:
                  container:
                    type: string
                  labelSelector:
                    description: |-
                      A label selector is a label query over a set of resources. The result of matchLabels and
                      matchExpressions are ANDed. An empty label selector matches all objects. A null
                      label selector matches no objects.
                    properties:
                      matchExpressions:
                        description: matchExpressions is a list of label selector
                          requirements. The requirements are ANDed.
                        items:
                          description: |-
                            A label selector requirement is a selector that contains values, a key, and an operator that
                            relates the key and values.
                          properties:
                            key:
                              description: key is the label key that the selector
                                applies to.
                              type: string
                            operator:
                              description: |-
                                operator represents a key's relationship to a set of values.
                                Valid operators are In, NotIn, Exists and DoesNotExist.
                              type: string
                            values:
                              description: |-
                                values is an array of string values. If the operator is In or NotIn,
                                the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                the values array must be empty. This array is replaced during a strategic
                                merge patch.
                              items:
                                type: string
                              type: array
                              x-kubernetes-list-type: atomic
                          required:
                          - key
                          - operator
                          type: object
                        type: array
                        x-kubernetes-list-type: atomic
                      matchLabels:
                        additionalProperties:
                          type: string
                        description: |-
                          matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                          map is equivalent to an element of matchExpressions, whose key field is "key", the
                          operator is "In", and the values array contains only "value". The requirements are ANDed.
                        type: object
                    type: object
                    x-kubernetes-map-type: atomic
                  namespaceSelector:
                    description: NamespaceSelector defines the namespace selection
                      criteria
                    properties:
                      matchNames:
                        items:
                          type: string
                        type: array
                      matchRegex:
                        type: string
                    type: object
                required:
                - labelSelector
                type: object
              tool:
                description: ToolSpec defines the tool configuration (renamed from
                  ProfilerSpec)
                properties:
                  args:
                    description: |-
                      Args provides additional arguments that will be appended to defaultArgs from PowerToolConfig
                      Users cannot override administrator-defined defaultArgs for security
                    items:
                      type: string
                    type: array
                  duration:
                    type: string
                  maxCPUPercent:
                    format: int32
                    type: integer
                  name:
                    type: string
                  resolutionPreset:
                    type: string
                  warmup:
                    type: string
                required:
                - duration
                - name
                type: object
              ttlSecondsAfterFinished:
                format: int32
                type: integer
            required:
            - output
            - targets
            - tool
            type: object
          status:
            description: status defines the observed state of PowerTool
            properties:
              activePods:
                additionalProperties:
                  type: string
                type: object
              artifacts:
                items:
                  type: string
                type: array
              bytesWritten:
                type: string
              completedPods:
                format: int32
                type: integer
              conditions:
                items:
                  description: PowerToolCondition represents a condition of a PowerTool
                  properties:
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      type: string
                    reason:
                      type: string
                    status:
                      type: string
                    type:
                      type: string
                  required:
                  - lastTransitionTime
                  - status
                  - type
                  type: object
                type: array
              finishedAt:
                format: date-time
                type: string
              lastError:
                type: string
              phase:
                type: string
              selectedPods:
                format: int32
                type: integer
              startedAt:
                format: date-time
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
